function OutClasses = robertson_classifier(Ratio, Qcn, varargin)
% Function to obtain a Robertson 2010 soil classification
%   
%   OutClasses = robertson_classifier(Ratio, Qcn)
%   
%   Dependencies: inpoly, getnan2 (dengwirda on github)
%   
% Outputs:
%   OutClasses : is the cell array containing the names of the classes
%   according to Robertson 2010
%   
% Required arguments:
%   - Ratio : the ratio between skin friction and cone resistance (fs/(qc-sigmv0)).
%   It must be given in percentage! This means that if the ratio is 0.02,
%   then the input must be 2, i.e., 2%.
%   
%   - Qcn : the cone resistance, normalized (Qcn = (qc-sigmv0)/sigmv0').
%   
% Optional arguments:
%   - 'OutMode', char/string : is to declare the desired output. It can be
%   one of the following: 'Classes' or 'Num'. The first is to specify that
%   you want the output as a class (Robertson 2010). The second is to
%   specify that you want the output as the conventional number of the class.
%   If no value is specified, then 'Classes' will be take as default!

%% Input check
if not(isnumeric(Ratio) && (isscalar(Ratio) || isvector(Ratio)))
    error('Ratio (1st input) must be a numeric scalar or vector!')
end

if not(isnumeric(Qcn) && (isscalar(Qcn) || isvector(Qcn)))
    error('Qcn (2nd input) must be a numeric scalar or vector!')
end

if not(isequal(numel(Ratio), numel(Qcn)))
    error('Ratio and Qcn must have the same size!')
end

if isvector(Ratio) && isrow(Ratio)
    Ratio = Ratio';
end

if isvector(Qcn) && isrow(Qcn)
    Qcn = Qcn';
end

%% Settings
OutMode = {'Classes'}; % Default

if ~isempty(varargin)
    StringPart = cellfun(@(x) (ischar(x) || isstring(x)), varargin);

    vararginCp = cellstr(strings(size(varargin))); % It is necessary because you want to find indices only for the string part
    vararginCp(StringPart) = cellfun(@(x) lower(string(x)), varargin(StringPart),  'Uniform',false);

    InputOutMode = find(cellfun(@(x) all(strcmpi(x, "outmode")), vararginCp));

    if InputOutMode; OutMode = varargin{InputOutMode+1}; end

    varargin([ InputOutMode, InputOutMode+1 ]) = [];
    if not(isempty(varargin))
        error(['Some optional inputs were not recognized: ', ...
               char(join(string(varargin), ', ')),'. Please check it!'])
    end
end

if not(iscellstr(OutMode) || ischar(OutMode) || isstring(OutMode))
    error('OutMode must be a cellstring, char, or string!')
end

OutMode = cellstr(OutMode);
if not(isscalar(OutMode))
    error('OutMode must be a scalar value!')
end

if not(any(strcmpi(OutMode, {'Classes','Num'})))
    error('OutMode must be Classes or Num!')
end

%% Core
RobPolysExp = repmat(polyshape, 1, 9);
RobPolysExp(1) = polyshape([-1	                0
                            -1	                1.00460945834792
                            -0.997001472241099	1.00463389010595
                            -0.956967723791156	1.00498136399790
                            -0.876958275826522	1.00245131972213
                            -0.819337701682518	0.996408531569903
                            -0.799428918578362	0.993615167235384
                            -0.779518133786782	0.990821802900864
                            -0.710946327754297	0.978747085155535
                            -0.691201683018785	0.974289646635340
                            -0.671457038283273	0.969834922754925
                            -0.651712393547761	0.965377484234729
                            -0.559422593246107	0.936873766535550
                            -0.540116318056121	0.929712546793603
                            -0.520808041178714	0.922548612411876
                            -0.501501765988728	0.915384678030149
                            -0.483804847486431	0.906274346925535
                            -0.408949744634727	0.867737320596243
                            -0.363484217195095	0.840905821002082
                            -0.345396769476669	0.829276304180817
                            -0.327309321758242	0.817649501999332
                            -0.309221673871073	0.806019985178067
                            -0.242440777575496	0.755609124447231
                            -0.225690256886555	0.740746471646945
                            -0.208939536028872	0.725886533486439
                            -0.158687933928302	0.681298575085579
                            -0.141937453273109	0.666438636925073
                            -0.129637084061864	0.653305209665203
                            -0.113908825139593	0.636515162620496
                            -0.0981803660485789	0.619725115575789
                            -0.0824519069575652	0.602932353891300
                            -0.0210225219860342	0.527989293460704
                            0.0210687609654940	0.469906860709118
                            0.0767316848102952	0.378152036115568
                            0.0998191475413772	0.333794822096082
                            0.111362878906919	0.311618929726120
                            0.139880919615236	0.248215803004020
                            0.149641147487332	0.224514283077207
                            0.159399373672006	0.200812763150394
                            0.169159601544102	0.177111243223580
                            0.178919829416198	0.153412437936548
                            0.212808397479075	0.0440667475629321
                            0.217023951190800	0.0258949488697999
                            0.223031015145768	0                 ]);

RobPolysExp(2) = polyshape([0.223031015145768	0
                            0.217023951190854	0.0258949488697597
                            0.212808397479075	0.0440667475629321
                            0.220889209603696	0.0480952729977495
                            0.239677047751254	0.0574607802417657
                            0.253260498600320	0.0639080497213422
                            0.272154426181271	0.0728745049175699
                            0.291046352074799	0.0818436747535786
                            0.309940279655750	0.0908101299498063
                            0.314388029108539	0.0935220550908996
                            0.332645420089135	0.104652078192484
                            0.350902811069732	0.115784815933850
                            0.369160202050328	0.126914839035434
                            0.387415591343503	0.138044862137019
                            0.405672982324099	0.149174885238603
                            0.408209120288403	0.150977406053104
                            0.425938065789461	0.163581478555703
                            0.443665009603095	0.176182836418521
                            0.496851846106268	0.213995053926319
                            0.514580791607325	0.226596411789138
                            0.525087648888013	0.236569998344070
                            0.541485472253110	0.252138457487384
                            0.557883295618206	0.267704201990917
                            0.574283120670726	0.283272661134231
                            0.590680944035822	0.298841120277545
                            0.607078767400919	0.314406864781078
                            0.623476590766016	0.329975323924392
                            0.639876415818500	0.345543783067766
                            0.656274239183600	0.361109527571266
                            0.672672062548700	0.376677986714566
                            0.681857806130500	0.388207061863966
                            0.696550191811697	0.406644895255624
                            0.711240575805404	0.425082728647322
                            0.725930959799111	0.443523276678801
                            0.740623345480240	0.461961110070499
                            0.770004113467653	0.498836776853895
                            0.784694497461360	0.517277324885374
                            0.799386883142489	0.535715158277072
                            0.814077267136100	0.554152991668866
                            0.817720338245100	0.560019328235266
                            0.830617210308290	0.580783607919147
                            0.843512080684017	0.601545172963274
                            0.856406951059744	0.622309452647181
                            0.869301821435400	0.643071017691366
                            0.882196691811100	0.663835297375266
                            0.895091562186900	0.684596862419366
                            0.907988434250000	0.705358427463566
                            0.916043224438202	0.720690712945846
                            0.927659016550952	0.742798739321286
                            0.939276810351100	0.764906765696766
                            0.962508394576600	0.809122818447666
                            0.968173169982295	0.821411992735624
                            1	                0.890472428761065
                            1	                0                ]);

RobPolysExp(3) = polyshape([1	                0.890472428761065
                            0.968173169982295	0.821411992735624
                            0.962508394576628	0.809122818447606
                            0.939276810351126	0.764906765696726
                            0.927659016550952	0.742798739321286
                            0.916043224438202	0.720690712945846
                            0.907988434250073	0.705358427463468
                            0.895091562186924	0.684596862419341
                            0.882196691811197	0.663835297375215
                            0.869301821435470	0.643071017691307
                            0.856406951059744	0.622309452647181
                            0.843512080684017	0.601545172963274
                            0.830617210308290	0.580783607919147
                            0.817720338245141	0.560019328235240
                            0.814077267136196	0.554152991668770
                            0.799386883142489	0.535715158277072
                            0.784694497461360	0.517277324885374
                            0.770004113467653	0.498836776853895
                            0.740623345480240	0.461961110070499
                            0.725930959799111	0.443523276678801
                            0.711240575805404	0.425082728647322
                            0.696550191811697	0.406644895255624
                            0.681857806130568	0.388207061863926
                            0.672672062548729	0.376677986714553
                            0.656274239183632	0.361109527571239
                            0.639876415818535	0.345543783067706
                            0.623476590766016	0.329975323924392
                            0.607078767400919	0.314406864781078
                            0.590680944035822	0.298841120277545
                            0.574283120670726	0.283272661134231
                            0.557883295618206	0.267704201990917
                            0.541485472253110	0.252138457487384
                            0.525087648888013	0.236569998344070
                            0.514580791607325	0.226596411789138
                            0.496851846106268	0.213995053926319
                            0.443665009603095	0.176182836418521
                            0.425938065789461	0.163581478555703
                            0.408209120288403	0.150977406053104
                            0.405672982324099	0.149174885238603
                            0.387415591343503	0.138044862137019
                            0.369160202050328	0.126914839035434
                            0.350902811069732	0.115784815933850
                            0.332645420089135	0.104652078192484
                            0.314388029108539	0.0935220550908996
                            0.309940279655750	0.0908101299498063
                            0.291046352074799	0.0818436747535786
                            0.272154426181271	0.0728745049175699
                            0.253260498600320	0.0639080497213422
                            0.239677047751254	0.0574607802417657
                            0.220889209603696	0.0480952729977495
                            0.212808397479075	0.0440667475629321
                            0.178919829416198	0.153412437936548
                            0.169159601544102	0.177111243223580
                            0.159399373672006	0.200812763150394
                            0.149641147487332	0.224514283077207
                            0.139880919615236	0.248215803004020
                            0.111362878906919	0.311618929726120
                            0.0998191475413772	0.333794822096082
                            0.0767316848102952	0.378152036115568
                            0.0210687609654940	0.469906860709118
                            -0.0210225219860342	0.527989293460704
                            -0.0824519069575652	0.602932353891300
                            -0.0981803660485789	0.619725115575789
                            -0.113908825139593	0.636515162620496
                            -0.129637084061864	0.653305209665203
                            -0.141937453273109	0.666438636925073
                            -0.132304732889826	0.671914065363097
                            -0.0953836083818659	0.692903660148816
                            -0.0769232462966281	0.703398457541676
                            -0.0215415595346877	0.734882849720256
                            -0.0038382356326383	0.747299612077975
                            0.0139415527289506	0.759767952591531
                            0.0317215412592815	0.772239007744867
                            0.0495007291146437	0.784710062898204
                            0.0672817184886860	0.797178403411759
                            0.0850607061753059	0.809649458565096
                            0.0905032942770756	0.814163904520690
                            0.124660088454567	0.842483026714770
                            0.141736483855891	0.856645302451591
                            0.175893278033382	0.884964424645671
                            0.192969673434706	0.899126700382493
                            0.210048070523451	0.913286261479533
                            0.214864130461979	0.917982588300445
                            0.231117832332656	0.933825226061628
                            0.263625236074010	0.965515930863554
                            0.279876936257265	0.981361283264517
                            0.296130638127942	0.997206635665480
                            0.312384339998619	1.01304927342666
                            0.344891743739973	1.04473997822859
                            0.355028288847499	1.05708615995201
                            0.369920843270878	1.07522266832803
                            0.384815399381679	1.09336026255996
                            0.399707953805058	1.11149758532791
                            0.414602509915859	1.12963517955985
                            0.429495064339238	1.14777250232780
                            0.444387618762617	1.16591009655974
                            0.459282174873418	1.18404769079167
                            0.474174729296797	1.20218501355963
                            0.480576125673900	1.21216945867384
                            0.506842268031951	1.25314151688642
                            0.519977340898377	1.27362754599278
                            0.546243483256385	1.31459960420552
                            0.559378556122800	1.33508563331194
                            0.598777769659800	1.39654372063104
                            0.611912842526200	1.41702974973744
                            0.625045913705200	1.43751577884374
                            0.634934249572300	1.45731744726154
                            0.646157710950300	1.47979466464714
                            0.657381172328200	1.50227215349674
                            0.668604633706200	1.52474937088224
                            0.679828095084100	1.54722685973204
                            0.689668390453100	1.57173462767364
                            0.699238458020100	1.59557622301314
                            0.708810527274400	1.61941808981664
                            0.718382596528800	1.64326104247614
                            0.727952664095800	1.66710100903164
                            0.737524733350200	1.69094369022704
                            0.743227540816300	1.70831467018317
                            0.751368403564205	1.73311561922291
                            0.759509266311501	1.75791385362119
                            0.767652130746219	1.78271480265926
                            0.775792993493515	1.80751303705755
                            0.790449348801040	1.80185844239399
                            0.828953808060195	1.78699850423348
                            0.848208039377195	1.77956853515323
                            0.862634200631132	1.77515181622975
                            0.882158659750169	1.76917146479248
                            0.901685120556629	1.76319111335521
                            0.921209579675667	1.75721347655773
                            1	                1.75721347655773]);

RobPolysExp(4) = polyshape([0.582061677994550	1.99095482025013
                            0.609729001548305	1.95171198757781
                            0.623562663325183	1.93209328588143
                            0.629785909521727	1.92326527731403
                            0.646247786884344	1.90782169160063
                            0.662709664246960	1.89237539124746
                            0.679169539922155	1.87693180553406
                            0.684716215769894	1.87172784107413
                            0.701708540299473	1.85738096983221
                            0.718702866516473	1.84303409859029
                            0.730238591132325	1.83329397105651
                            0.767185737576777	1.81238581546422
                            0.775792993493515	1.80751303705755
                            0.767652130746219	1.78271480265926
                            0.759509266311501	1.75791385362119
                            0.751368403564205	1.73311561922291
                            0.743227540816909	1.70831467018484
                            0.737524733350214	1.69094369022703
                            0.727952664095833	1.66710100903161
                            0.718382596528874	1.64326104247597
                            0.708810527274493	1.61941808981657
                            0.699238458020111	1.59557622301309
                            0.689668390453152	1.57173462767358
                            0.679828095084156	1.54722685973185
                            0.668604633706214	1.52474937088223
                            0.657381172328273	1.50227215349659
                            0.646157710950331	1.47979466464697
                            0.634934249572390	1.45731744726134
                            0.625045913705254	1.43751577884373
                            0.611912842526250	1.41702974973736
                            0.598777769659823	1.39654372063099
                            0.559378556122812	1.33508563331189
                            0.546243483256385	1.31459960420552
                            0.519977340898377	1.27362754599278
                            0.506842268031951	1.25314151688642
                            0.480576125673943	1.21216945867368
                            0.474174729296797	1.20218501355963
                            0.459282174873418	1.18404769079167
                            0.444387618762617	1.16591009655974
                            0.429495064339238	1.14777250232780
                            0.414602509915859	1.12963517955985
                            0.399707953805058	1.11149758532791
                            0.384815399381679	1.09336026255996
                            0.369920843270878	1.07522266832803
                            0.355028288847499	1.05708615995201
                            0.344891743739973	1.04473997822859
                            0.312384339998619	1.01304927342666
                            0.296130638127942	0.997206635665480
                            0.279876936257265	0.981361283264517
                            0.263625236074010	0.965515930863554
                            0.231117832332656	0.933825226061628
                            0.214864130461979	0.917982588300445
                            0.210048070523451	0.913286261479533
                            0.192969673434706	0.899126700382493
                            0.175893278033382	0.884964424645671
                            0.141736483855891	0.856645302451591
                            0.124660088454567	0.842483026714770
                            0.0905032942770756	0.814163904520690
                            0.0850607061753059	0.809649458565096
                            0.0672817184886860	0.797178403411759
                            0.0495007291146437	0.784710062898204
                            0.0317215412592815	0.772239007744867
                            0.0139415527289506	0.759767952591531
                            -0.0038382356326383	0.747299612077975
                            -0.0215415595346877	0.734882849720256
                            -0.0769232462966281	0.703398457541676
                            -0.0953836083818659	0.692903660148816
                            -0.132304732889826	0.671914065363097
                            -0.141937453273109	0.666438636925073
                            -0.158687933928302	0.681298575085579
                            -0.208939536028872	0.725886533486439
                            -0.225690256886555	0.740746471646945
                            -0.242440777575496	0.755609124447231
                            -0.309221673871073	0.806019985178067
                            -0.327309321758242	0.817649501999332
                            -0.345396769476669	0.829276304180817
                            -0.363484217195095	0.840905821002082
                            -0.408949744634727	0.867737320596243
                            -0.483804847486431	0.906274346925535
                            -0.501501765988728	0.915384678030149
                            -0.492446132089351	0.919850260469687
                            -0.473634273692723	0.929123469961154
                            -0.454820413608672	0.938396679452620
                            -0.436008555212044	0.947672603583867
                            -0.417196696815416	0.956945813075334
                            -0.398382836731365	0.966221737206581
                            -0.379570978334736	0.975494946698048
                            -0.366274169124572	0.982610017563719
                            -0.347654072383019	0.992572745559528
                            -0.329034175810208	1.00253547355534
                            -0.310414279237397	1.01250091619093
                            -0.291794382664586	1.02246364418673
                            -0.273174285923033	1.03242637218254
                            -0.235934492777411	1.05235182817416
                            -0.218455157697939	1.06318595553963
                            -0.200249009915359	1.07446799846894
                            -0.182043122352143	1.08575167018213
                            -0.145631460760900	1.10831774574054
                            -0.127425219460005	1.11960078507382
                            -0.109219271846100	1.13088391385907
                            -0.104783732686600	1.13425603939487
                            -0.0873234136392000	1.14753089938624
                            -0.0698628944199961	1.16080575937976
                            -0.0524025753710378	1.17408034790823
                            -0.0349422563220795	1.18735520790069
                            -0.0174819372731212	1.20062979642916
                            -2.16182241630225e-05	1.21390465642162
                            0.0174387008247954	1.22717924495009
                            0.0348984193675268	1.24045410494254
                            0.0523591387539697	1.25372896493500
                            0.0698198581404000	1.26700355346347
                            0.0872805775268000	1.28027841345597
                            0.104741296913200	1.29355300198447
                            0.111296823221900	1.30003691910117
                            0.127470457595753	1.31603130522595
                            0.143644091969530	1.33202552847250
                            0.224512263838400	1.41199735051157
                            0.240685898212100	1.42799146517257
                            0.256859532585900	1.44398585129767
                            0.270368921000400	1.46110817025137
                            0.299617577617932	1.49817874817101
                            0.314241905926696	1.51671376566686
                            0.328868235922883	1.53524905462670
                            0.343492564231647	1.55378434358653
                            0.358116892540412	1.57231936108238
                            0.387365549157940	1.60938993900204
                            0.401989877466700	1.62792604235387
                            0.416616207462800	1.64645888813807
                            0.420385384879400	1.65308803848277
                            0.432609689968600	1.67458527090757
                            0.444831993370000	1.69608250333164
                            0.469280603548792	1.73907696818171
                            0.481504908637982	1.76057148596667
                            0.505953518816300	1.80356595081617
                            0.516522428407147	1.82680326734044
                            0.548049005311400	1.89611616486557
                            0.555795535635900	1.91771655360044]);

RobPolysExp(5) = polyshape([0.281125989208903	2.14956307872727
                            0.294172987828700	2.17014819218570
                            0.307221988135900	2.19073602028390
                            0.317010239632000	2.21115825535540
                            0.338828632537200	2.25667733520080
                            0.349737828989800	2.27943958976350
                            0.360647025442400	2.30219912968630
                            0.371558223582400	2.32495866960910
                            0.382467420035000	2.34772092417180
                            0.393376616487600	2.37048046409460
                            0.404085644198059	2.34754718722599
                            0.414796673595841	2.32461119571738
                            0.425505701306201	2.30167791884856
                            0.436216730703984	2.27874464197973
                            0.446925758414343	2.25581136511091
                            0.468345815522486	2.20994209673347
                            0.479056844920268	2.18700881986465
                            0.498391143734168	2.14560784856653
                            0.522073107629732	2.10183428209994
                            0.533915090421225	2.07994614154675
                            0.557597054316789	2.03617257508015
                            0.582061677994550	1.99095482025013
                            0.555795535636542	1.91771655360192
                            0.548049005311478	1.89611616486550
                            0.516522428407147	1.82680326734044
                            0.505953518816362	1.80356595081616
                            0.481504908637982	1.76057148596667
                            0.469280603548792	1.73907696818171
                            0.444831993370411	1.69608250333222
                            0.432609689968644	1.67458527090748
                            0.420385384879454	1.65308803848273
                            0.416616207462891	1.64645888813784
                            0.401989877466705	1.62792604235381
                            0.387365549157940	1.60938993900204
                            0.358116892540412	1.57231936108238
                            0.343492564231647	1.55378434358653
                            0.328868235922883	1.53524905462670
                            0.314241905926696	1.51671376566686
                            0.299617577617932	1.49817874817101
                            0.270368921000403	1.46110817025135
                            0.256859532585970	1.44398585129746
                            0.240685898212193	1.42799146517253
                            0.224512263838416	1.41199735051157
                            0.192164995090862	1.38000857826171
                            0.143644091969530	1.33202552847250
                            0.127470457595753	1.31603130522595
                            0.111296823221976	1.30003691910102
                            0.104741296913298	1.29355300198440
                            0.0872805775268553	1.28027841345593
                            0.0698198581404124	1.26700355346347
                            0.0523591387539697	1.25372896493500
                            0.0348984193675268	1.24045410494254
                            0.0174387008247954	1.22717924495009
                            -2.16182241630225e-05	1.21390465642162
                            -0.0174819372731212	1.20062979642916
                            -0.0349422563220795	1.18735520790069
                            -0.0524025753710378	1.17408034790823
                            -0.0698628944199961	1.16080575937976
                            -0.0873234136376965	1.14753089938731
                            -0.104783732686655	1.13425603939485
                            -0.109219271846166	1.13088391385905
                            -0.127425219460005	1.11960078507382
                            -0.145631167073843	1.10831792775258
                            -0.182043122352143	1.08575167018213
                            -0.200249009915359	1.07446799846894
                            -0.218455157697939	1.06318595553963
                            -0.235934492777411	1.05235182817416
                            -0.273174285923033	1.03242637218254
                            -0.291794382664586	1.02246364418673
                            -0.310414279237397	1.01250091619093
                            -0.329034175810208	1.00253547355534
                            -0.347654072383019	0.992572745559528
                            -0.366274169124572	0.982610017563719
                            -0.379570978334736	0.975494946698048
                            -0.398382836731365	0.966221737206581
                            -0.417196696815416	0.956945813075334
                            -0.436008555212044	0.947672603583867
                            -0.454820413608672	0.938396679452620
                            -0.473634273692723	0.929123469961154
                            -0.492446132089351	0.919850260469687
                            -0.501501765988728	0.915384678030149
                            -0.520808041178714	0.922548612411876
                            -0.540116318056121	0.929712546793603
                            -0.559422593246107	0.936873766535550
                            -0.651712393547761	0.965377484234729
                            -0.671457038283273	0.969834922754925
                            -0.691201683018785	0.974289646635340
                            -0.710946327754297	0.978747085155535
                            -0.779518133786782	0.990821802900864
                            -0.799428918578362	0.993615167235384
                            -0.819337701682518	0.996408531569903
                            -0.876958275826522	1.00245131972213
                            -0.956967723791156	1.00498136399790
                            -0.997001472241099	1.00463389010595
                            -1	                1.00460945834792
                            -1	                1.42546332114460
                            -0.993082168267850	1.42597204463954
                            -0.953108470440581	1.42891199952222
                            -0.933119619839525	1.43038197696357
                            -0.893145922012256	1.43332193184625
                            -0.873157071411200	1.43479190928760
                            -0.853170222497566	1.43626188672894
                            -0.841078028778260	1.43821425565935
                            -0.801324516567466	1.44463220702929
                            -0.781447760462070	1.44784145417824
                            -0.741694248251276	1.45425940554818
                            -0.721835507332681	1.45999055305356
                            -0.702257002653237	1.46564053282950
                            -0.643521488614902	1.48259128654923
                            -0.623942983935458	1.48824126632516
                            -0.584785974576568	1.49954176880499
                            -0.565207469897123	1.50519174858092
                            -0.506471955858789	1.52214250230066
                            -0.486893451179344	1.52779248207659
                            -0.472699485666417	1.53411406373431
                            -0.453681453465271	1.54258346838666
                            -0.434663421264126	1.55105314450299
                            -0.415647390750403	1.55952254915534
                            -0.396629358549257	1.56799195380769
                            -0.377611326348111	1.57646162992402
                            -0.358593494315708	1.58493103457637
                            -0.339575862452047	1.59340071069269
                            -0.320558030419644	1.60187011534504
                            -0.301540398555900	1.61033979146140
                            -0.282522766692300	1.61880919611380
                            -0.273092416907400	1.62441329847740
                            -0.254757960961000	1.63530443327830
                            -0.199753992615775	1.66798598160017
                            -0.181419476618700	1.67887711640120
                            -0.163084880554300	1.68977096584170
                            -0.161113959067400	1.69122872740410
                            -0.143539403717300	1.70422370803510
                            -0.125964988486600	1.71721868866527
                            -0.108390373084510	1.73021366929715
                            -0.0908159578524695	1.74320593528842
                            -0.0732413424516867	1.75620091591946
                            -0.0556669272196462	1.76919589655051
                            -0.0380923118188000	1.78219087718160
                            -0.0205178965868000	1.79518585781260
                            -0.0085652204808000	1.80588968246860
                            0.00813886105750000	1.82084734765937
                            0.0248431427693547	1.83580501285382
                            0.0415480249850000	1.85076267804660
                            0.0582521065258000	1.86572034323920
                            0.0741975485334000	1.88385685161510
                            0.104871406595760	1.91874540207887
                            0.120206333939511	1.93618967731077
                            0.150880192001857	1.97107822777457
                            0.166217121033031	1.98852521764624
                            0.212227908126500	2.04085804334210
                            0.215886992734800	2.04662936751610
                            0.228933991354700	2.06721719561430
                            0.241980989973800	2.08780230907157
                            0.255029990281808	2.10839013717075
                            0.268076988901644	2.12897525062912]);

RobPolysExp(6) = polyshape([0.0184647657975674	3
                            0.141892615474845	3
                            0.150974271310715	2.97580984491263
                            0.160055927146585	2.95161697518548
                            0.178221240505746	2.90323395037096
                            0.196384552177486	2.85485364019621
                            0.205466208013355	2.83066077046906
                            0.214547863849225	2.80647061538169
                            0.221345594336025	2.78836668268304
                            0.230765535346297	2.76441270125661
                            0.240183474669146	2.74046143446995
                            0.249603415679418	2.71650745304352
                            0.259023356689690	2.69255618625686
                            0.268443297699961	2.66860220483043
                            0.277863238710233	2.64465093804378
                            0.287283179720504	2.62069695661734
                            0.298724825027498	2.59160416208571
                            0.308773295888434	2.56812524262093
                            0.318823768436792	2.54464903779593
                            0.328872239297728	2.52117283297093
                            0.338922711846086	2.49769391350615
                            0.348971182707022	2.47421770868115
                            0.359021655255380	2.45073878921636
                            0.369070126116316	2.42726258439136
                            0.389169069525610	2.38030746010158
                            0.393376616487699	2.37048046409482
                            0.382467420035090	2.34772092417197
                            0.371558223582480	2.32495866960934
                            0.360647025442448	2.30219912968649
                            0.349737828989839	2.27943958976364
                            0.338828632537229	2.25667733520101
                            0.317010239632010	2.21115825535531
                            0.307221988135999	2.19073602028379
                            0.294172987828740	2.17014819218564
                            0.281125989208903	2.14956307872727
                            0.268076988901644	2.12897525062912
                            0.255029990281808	2.10839013717075
                            0.241980989974549	2.08780230907260
                            0.228933991354712	2.06721719561423
                            0.215886992734876	2.04662936751608
                            0.212227908126551	2.04085804334194
                            0.166217121033031	1.98852521764624
                            0.150880192001857	1.97107822777457
                            0.120206333939511	1.93618967731077
                            0.104871406595760	1.91874540207887
                            0.0741975485334137	1.88385685161507
                            0.0582521065258013	1.86572034323905
                            0.0415480249850626	1.85076267804644
                            0.0248431427693547	1.83580501285382
                            0.00813886105987360	1.82084734766120
                            -0.00856522048086539	1.80588968246858
                            -0.0205178965868227	1.79518585781260
                            -0.0380923118188633	1.78219087718155
                            -0.0556669272196462	1.76919589655051
                            -0.0732413424516867	1.75620091591946
                            -0.0908159578524695	1.74320593528842
                            -0.108390373084510	1.73021366929715
                            -0.125964988485293	1.71721868866611
                            -0.143539403717334	1.70422370803506
                            -0.161113959067494	1.69122872740402
                            -0.163084880554307	1.68977096584169
                            -0.181419476618790	1.67887711640104
                            -0.199753992615775	1.66798598160017
                            -0.254757960961090	1.63530443327823
                            -0.273092416907453	1.62441329847736
                            -0.282522766692322	1.61880919611372
                            -0.301540398555983	1.61033979146137
                            -0.320558030419644	1.60187011534504
                            -0.339575862452047	1.59340071069269
                            -0.358593494315708	1.58493103457637
                            -0.377611326348111	1.57646162992402
                            -0.396629358549257	1.56799195380769
                            -0.415647390750403	1.55952254915534
                            -0.434663421264126	1.55105314450299
                            -0.453681453465271	1.54258346838666
                            -0.472699485666417	1.53411406373431
                            -0.486893451179344	1.52779248207659
                            -0.506471955858789	1.52214250230066
                            -0.565207469897123	1.50519174858092
                            -0.584785974576568	1.49954176880499
                            -0.623942983935458	1.48824126632516
                            -0.643521488614902	1.48259128654923
                            -0.702257002653237	1.46564053282950
                            -0.721835507332681	1.45999055305356
                            -0.741694248251276	1.45425940554818
                            -0.781447760462070	1.44784145417824
                            -0.801324516567466	1.44463220702929
                            -0.841078028778260	1.43821425565935
                            -0.853170222497566	1.43626188672894
                            -0.873157071411200	1.43479190928760
                            -0.893145922012256	1.43332193184625
                            -0.933119619839525	1.43038197696357
                            -0.953108470440581	1.42891199952222
                            -0.993082168267850	1.42597204463954
                            -1	                1.42546332114460
                            -1	                2.18605598130156
                            -0.963479212976539	2.19012251169331
                            -0.923579577583903	2.19456637701460
                            -0.903630760731297	2.19678966699514
                            -0.883679942191267	2.20231124430944
                            -0.844454875460013	2.21316708879315
                            -0.824842342094386	2.21859636835490
                            -0.785617275363131	2.22945221283862
                            -0.766004741997504	2.23488149240037
                            -0.726779675266250	2.24573733688408
                            -0.687606652407980	2.26311103148168
                            -0.668580613457144	2.27155084656042
                            -0.649556576193731	2.27998794699937
                            -0.630530537242896	2.28842504743833
                            -0.611504498292060	2.29686486251707
                            -0.592480461028647	2.30530196295603
                            -0.554428383126976	2.32217616383394
                            -0.535404345863563	2.33061597891268
                            -0.527627790227162	2.33555933795365
                            -0.491381234380583	2.35860662969327
                            -0.473255954769871	2.37013027556308
                            -0.418886121000003	2.40470121317252
                            -0.400760841389291	2.41622485904233
                            -0.382637563466002	2.42774850491214
                            -0.364513685036486	2.43927215078195
                            -0.353484387338526	2.44957149411059
                            -0.336998289558098	2.46496893094771
                            -0.320512391946411	2.48036365314505
                            -0.287540596723000	2.51115852681916
                            -0.271054699111300	2.52655324901646
                            -0.238082903887900	2.55734812269076
                            -0.229113943053900	2.56829355028726
                            -0.214235600611300	2.58645449042126
                            -0.199357057999800	2.60461543055526
                            -0.184478675523400	2.62277365604966
                            -0.154721810486200	2.65909553631766
                            -0.139930161125800	2.68124428228986
                            -0.126492833458600	2.70136247770586
                            -0.0861808504569000	2.76172520787346
                            -0.0755691047553000	2.78235375556836
                            -0.0412093394731000	2.84914203809706
                            -0.0297558842103000	2.87140751357996
                            -0.0183026291163000	2.89367027442276
                            -0.0155300918674000	2.90168932033546
                            -0.0070313274090000	2.92626766891166
                            0.00146723688060000	2.95084601748766
                            0.00996600133910000	2.97542165142396]);

RobPolysExp(7) = polyshape([0.0184647657975674	3
                            0.00996600133912895	2.97542165142396
                            0.00146723688069050	2.95084601748771
                            -0.00703132740900581	2.92626766891167
                            -0.0155300918674443	2.90168932033564
                            -0.0183026291163451	2.89367027442294
                            -0.0297558842103894	2.87140751357999
                            -0.0412093394731758	2.84914203809725
                            -0.0755691047553088	2.78235375556840
                            -0.0861808504569352	2.76172520787354
                            -0.126492833458606	2.70136247770602
                            -0.139930161125829	2.68124428228996
                            -0.154721810486240	2.65909553631781
                            -0.184478675523466	2.62277365604971
                            -0.199357057999894	2.60461543055544
                            -0.214235600611315	2.58645449042139
                            -0.229113943053995	2.56829355028734
                            -0.238082903887978	2.55734812269086
                            -0.271054699111351	2.52655324901662
                            -0.287540596723037	2.51115852681928
                            -0.320512391946411	2.48036365314505
                            -0.336998289558098	2.46496893094771
                            -0.353484387338526	2.44957149411059
                            -0.364513685036486	2.43927215078195
                            -0.382637563466002	2.42774850491214
                            -0.400760841389291	2.41622485904233
                            -0.418886121000003	2.40470121317252
                            -0.473255954769871	2.37013027556308
                            -0.491381234380583	2.35860662969327
                            -0.527627790227162	2.33555933795365
                            -0.535404345863563	2.33061597891268
                            -0.554428383126976	2.32217616383394
                            -0.592480461028647	2.30530196295603
                            -0.611504498292060	2.29686486251707
                            -0.630530537242896	2.28842504743833
                            -0.649556576193731	2.27998794699937
                            -0.668580613457144	2.27155084656042
                            -0.687606652407980	2.26311103148168
                            -0.726779675266250	2.24573733688408
                            -0.766004741997504	2.23488149240037
                            -0.785617275363131	2.22945221283862
                            -0.824842342094386	2.21859636835490
                            -0.844454875460013	2.21316708879315
                            -0.883679942191267	2.20231124430944
                            -0.903630760731297	2.19678966699514
                            -0.923579577583903	2.19456637701460
                            -0.963479212976539	2.19012251169331
                            -1	                2.18605598130156
                            -1	                3               ]);

RobPolysExp(8) = polyshape([0.141892615474845	3
                            0.675936814734822	3
                            0.675936814734822	2.89141440876503
                            0.675230219074680	2.84517323473762
                            0.673817027754397	2.79091301479750
                            0.673112433781678	2.76378290482744
                            0.672405838121537	2.73665550949717
                            0.671699242461395	2.70952539952711
                            0.671092731172378	2.68622564628787
                            0.669773619160953	2.65913897055430
                            0.667131391763257	2.60496561908718
                            0.665810278064408	2.57787622871383
                            0.664491166052983	2.55078955298027
                            0.661848938655286	2.49661620151314
                            0.660529826643861	2.46952952577958
                            0.659208712945013	2.44244013540623
                            0.655221351599399	2.39449416759643
                            0.652260855901525	2.36764638016358
                            0.649302361891074	2.34079859273074
                            0.646341866193201	2.31395080529789
                            0.643383372182750	2.28710301786504
                            0.628054449901267	2.18381911812212
                            0.618306232153706	2.13116053565272
                            0.594826438687814	2.03423160763682
                            0.587392171600660	2.00902617727141
                            0.582061677994550	1.99095482025013
                            0.557597054316789	2.03617257508015
                            0.533915090421225	2.07994614154675
                            0.522073107629732	2.10183428209994
                            0.498391143734168	2.14560784856653
                            0.479056844920268	2.18700881986465
                            0.468345815522486	2.20994209673347
                            0.446925758414343	2.25581136511091
                            0.436216730703984	2.27874464197973
                            0.425505701306201	2.30167791884856
                            0.414796673595841	2.32461119571738
                            0.404085644198059	2.34754718722599
                            0.393376616487699	2.37048046409482
                            0.389169069525610	2.38030746010158
                            0.369070126116316	2.42726258439136
                            0.359021655255380	2.45073878921636
                            0.348971182707022	2.47421770868115
                            0.338922711846086	2.49769391350615
                            0.328872239297728	2.52117283297093
                            0.318823768436792	2.54464903779593
                            0.308773295888434	2.56812524262093
                            0.298724825027498	2.59160416208571
                            0.287283179720504	2.62069695661734
                            0.277863238710233	2.64465093804378
                            0.268443297699961	2.66860220483043
                            0.259023356689690	2.69255618625686
                            0.249603415679418	2.71650745304352
                            0.240183474669146	2.74046143446995
                            0.230765535346297	2.76441270125661
                            0.221345594336025	2.78836668268304
                            0.214547863849225	2.80647061538169
                            0.205466208013355	2.83066077046906
                            0.196384552177486	2.85485364019621
                            0.178221240505746	2.90323395037096
                            0.160055927146585	2.95161697518548
                            0.150974271310715	2.97580984491263]);

RobPolysExp(9) = polyshape([1	                1.75721347655773
                            0.921209579675667	1.75721347655773
                            0.901685120556629	1.76319111335521
                            0.882158659750169	1.76917146479248
                            0.862634200631132	1.77515181622975
                            0.848208039377195	1.77956853515323
                            0.828953808060195	1.78699850423348
                            0.790449348801040	1.80185844239399
                            0.775792993493515	1.80751303705755
                            0.767185737576777	1.81238581546422
                            0.730238591132325	1.83329397105651
                            0.718702866516473	1.84303409859029
                            0.701708540299473	1.85738096983221
                            0.684716215769894	1.87172784107413
                            0.679169539922155	1.87693180553406
                            0.662709664246960	1.89237539124746
                            0.646247786884344	1.90782169160063
                            0.629785909521727	1.92326527731403
                            0.623562663325183	1.93209328588143
                            0.609729001548305	1.95171198757781
                            0.582061677994550	1.99095482025013
                            0.587392171600660	2.00902617727141
                            0.594826438687814	2.03423160763682
                            0.618306232153706	2.13116053565272
                            0.628054449901267	2.18381911812212
                            0.643383372182750	2.28710301786504
                            0.646341866193201	2.31395080529789
                            0.649302361891074	2.34079859273074
                            0.652260855901525	2.36764638016358
                            0.655221351599399	2.39449416759643
                            0.659208712945013	2.44244013540623
                            0.660529826643861	2.46952952577958
                            0.661848938655286	2.49661620151314
                            0.664491166052983	2.55078955298027
                            0.665810278064408	2.57787622871383
                            0.667131391763257	2.60496561908718
                            0.669773619160953	2.65913897055430
                            0.671092731172378	2.68622564628787
                            0.671699242461395	2.70952539952711
                            0.672405838121537	2.73665550949717
                            0.673112433781678	2.76378290482744
                            0.673817027754397	2.79091301479750
                            0.675230219074680	2.84517323473762
                            0.675936814734822	2.89141440876503
                            0.675936814734822	3
                            1	                3               ]);

ClassOrd = {'Sensitive, fine-grained', ...
            'Organic soils - clay', ...
            'Clay - silty clay to clay', ...
            'Silt mixtures - clayey silt to silty clay', ...
            'Sand mixtures - silty sand to sandy silt', ...
            'Sands - clean sand to silty sand', ...
            'Gravelly sand to dense sand', ...
            'Very stiff sand to clayey sand (overconsolidated)', ...
            'Very stiff fine-grained (overconsolidated)'}; % Robertson 2010

RobPolysExpTable = array2table(RobPolysExp, 'VariableNames',ClassOrd, 'RowNames',{'Exp Coords Poly'});

% load([pwd,filesep,'RobPolysExp.mat'], 'RobPolysExpTable') % It was already written manually!

RatioExp = log10(Ratio); % taking the exponent because the polygons have exponential coordinates!
QcnExp   = log10(Qcn); % taking the exponent because the polygons have exponential coordinates!

IndIntPol = false(numel(RatioExp), numel(RobPolysExpTable));
for i1 = 1:numel(RobPolysExpTable)
    [pp1, ee1] = getnan2([RobPolysExpTable{1, i1}.Vertices; nan, nan]);
    IndIntPol(:,i1)  = inpoly([RatioExp,QcnExp], pp1,ee1);
end

IntPres = sum(IndIntPol, 2);
for i1 = 1:numel(IntPres)
    if IntPres(i1) > 1
        error(['Point n. ',num2str(i1),' has more than one class! Contact the support...'])
    elseif IntPres(i1) == 0
        error(['Point n. ',num2str(i1),' is outside the range [0.1, 10] for Ratio or [1, 1000] for Qcn!'])
    end
end

NumClassInt = zeros(numel(RatioExp), 1);
for i1 = 1:numel(NumClassInt)
    NumClassInt(i1) = find(IndIntPol(i1, :));
end

switch OutMode{:}
    case 'Classes'
        PossClsses = RobPolysExpTable.Properties.VariableNames;
        OutClasses = PossClsses(NumClassInt);

    case 'Num'
        OutClasses = NumClassInt;

    otherwise
        error('OutMode not recognized!')
end

end